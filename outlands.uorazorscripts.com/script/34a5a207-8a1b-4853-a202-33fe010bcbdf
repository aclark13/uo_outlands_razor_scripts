# This is an automated backup - check out https://outlands.uorazorscripts.com/script/34a5a207-8a1b-4853-a202-33fe010bcbdf for latest
# Automation by Jaseowns
## Script: Melee weapons swap and hide in a trapped pouch
## Created by: DoubleDuke#6321
#############################################

# Melee weapons swap and hide in a trapped pouch by Double Duke
# Version 0.5 2023/04/14
# Script for UO Outlands
#
# The script ask you to set 3 weapons: 1x onehanded - 1x twohanded - 1x secondary twohanded or bow/crossbow
# Then equip the first weapon in line and hide the others in your next free trapped pouch available
#
# After setup, every trigger of the script, will do this for you:
#
#   - check for free trapped pouches available and set as safepouch (thief proof)
#   - check if your weapons are still there
#   - look into actually equipped weapon and swap with the next
#   - hide all the selected weapons left laying in backpack
#
# Remove the variables (in option section of Razor) myFirstWeapon, mySecondWeapon and myThirdWeapon if:
#   - your char dies and lose weapons
#   - you change your weapons
# or....simply copy these lines to another script and run it once to re-set your weapons (remove the hash before play):
#
#   overhead "Set your Onehanded weapon" 2843
#   @setvar! myFirstWeapon
#   overhead "Set your Twohanded Weapon" 2843
#   @setvar! mySecondWeapon
#   overhead "Set your Bow or another Twohanded weapon" 2843
#   @setvar! myThirdWeapon
#
# NOTE: try the script before intensive use (pvp or dungeon crawling), test it with your thief or friends
#
# ROADMAP:
#   - free weapons type choice (ex: 3 onehanded or 3 twohanded etc..)
#   - variable selector for 2 weapons or more than 3
#   - shield equip variable selector
#   - speed improvement
#
# WARNING: the script is not pefect, always set a stop script macro for emergency;
# Set a normal equip weapon macro for all your weapons, for your safety.
#
# REPORT: any feedback or collaboration on Discord @ DoubleDuke#6321

#############
### EDIT TO MEET YOUR PREFERENCES
#############

### Fine tune this to your Latency or Personal Preferences
# GlobalWaitTime safe value is 650
@setvar! globalWaitTimeLiftAndDrop 650
# WaitForPing safe value is 200
@setvar! minimumWaitForPing 200


#############
### DO NOT EDIT BELOW THIS
#############


// Automatically set your trapped pouch every time
// Even if you or someone trigger it (thief proof)
if findtype "pouch" backpack 38 as trappedsafepouch
    @setvar! safepouch trappedsafepouch
endif

// Weapons Variable selector

if not varexist myFirstWeapon
    overhead "Set your Onehanded weapon" 2843
    @setvar! myFirstWeapon
endif

if not varexist mySecondWeapon
    overhead "Set your Twohanded Weapon" 2843
    @setvar! mySecondWeapon
endif

if not varexist myThirdWeapon
    overhead "Set your Bow or another Twohanded weapon" 2843
    @setvar! myThirdWeapon
endif
    
// Check if wrong weapon equipped

if not find righthand myFirstWeapon and not find lefthand mySecondWeapon and not find lefthand myThirdWeapon
    if find myFirstWeapon backpack as item
        overhead "Wrong weapon! Now swapping..." 2843
        dclick item
        wait minimumWaitForPing
    elseif find mySecondWeapon backpack as item
        overhead "Wrong weapon! Now swapping..." 2843
        dclick item
        wait minimumWaitForPing
    elseif find myThirdWeapon backpack as item
        overhead "Wrong weapon! Now swapping..." 2843
        dclick item
        wait minimumWaitForPing
    else
        overhead "No weapon at all in backpack!" 2843
    endif 


// Check if you need to equip a weapon and equip the first available

elseif not findlayer self lefthand and not findlayer self righthand
    if find myFirstWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find mySecondWeapon backpack as upSecondWpn and find myThirdWeapon backpack as upThirdWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find mySecondWeapon backpack as upSecondWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myThirdWeapon backpack as upThirdWpn
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    elseif find mySecondWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find myThirdWeapon backpack as upThirdWpn
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    elseif find myThirdWeapon backpack as item
        dclick item
        wait minimumWaitForPing
    else
        overhead "No weapon at all in backpack!" 2843
    endif
    
// Equip Second Weapon
    
elseif find myFirstWeapon righthand
    if find mySecondWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find myFirstWeapon backpack as upFirstWpn and find myThirdWeapon backpack as upThirdWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myFirstWeapon backpack as upFirstWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myThirdWeapon backpack as upThirdWpn
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    elseif find myThirdWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find myFirstWeapon backpack as upFirstWpn and find mySecondWeapon backpack as upSecondWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myFirstWeapon backpack as upFirstWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find mySecondWeapon backpack as upSecondWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    else
        overhead "No more weapons left!" 2843
    endif
    
// Equip Third Weapon
    
elseif find mySecondWeapon lefthand
    if find myThirdWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find myFirstWeapon backpack as upFirstWpn and find mySecondWeapon backpack as upSecondWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myFirstWeapon backpack as upFirstWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find mySecondWeapon backpack as upSecondWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    elseif find myFirstWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find mySecondWeapon backpack as upSecondWpn and find myThirdWeapon backpack as upThirdWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find mySecondWeapon backpack as upSecondWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myThirdWeapon backpack as upThirdWpn
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    else
        overhead "No more weapons left!" 2843
    endif
    
// Equip First Weapon
    
elseif find myThirdWeapon lefthand
    if find myFirstWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find mySecondWeapon backpack as upSecondWpn and find myThirdWeapon backpack as upThirdWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find mySecondWeapon backpack as upSecondWpn
            lift upSecondWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myThirdWeapon backpack as upThirdWpn
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    elseif find mySecondWeapon backpack as item
        dclick item
        wait minimumWaitForPing
        if find myFirstWeapon backpack as upFirstWpn and find myThirdWeapon backpack as upThirdWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myFirstWeapon backpack as upFirstWpn
            lift upFirstWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        elseif find myThirdWeapon backpack as upThirdWpn
            lift upThirdWpn
            drop safepouch -1 -1 -1
            wait globalWaitTimeLiftAndDrop
        endif
    else
        overhead "No more weapons left!" 2843
    endif
endif

// If you wish to collaborate to improve this script please contact me in Discord @ DoubleDuke#6321
//
//